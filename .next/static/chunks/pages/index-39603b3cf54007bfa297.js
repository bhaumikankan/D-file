(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{53176:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return F}});var i=t(85893),r=t(809),a=t.n(r),s=t(30266),l=t(99756),u=t(67294),c=(t(49186),t(95712)),p=t(81935),d=t(15316),o=t(28551),f=t(47924),h=t(48237),x=t(68788),y=t(42224),Z=t(32150),m=t(3283),j=t.n(m),w="undefined"!==typeof window.web3?new(j())(window.web3.currentProvider):new(j())(new(j().providers.HttpProvider)("https://rinkeby.infura.io/v3/c418d4eba8b84ff092648af21a3e7e6f")),b=JSON.parse('{"Mt":[{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"Files","outputs":[{"internalType":"uint256","name":"fileId","type":"uint256"},{"internalType":"string","name":"filename","type":"string"},{"internalType":"string","name":"filehash","type":"string"},{"internalType":"uint256","name":"filesize","type":"uint256"},{"internalType":"string","name":"filedescription","type":"string"},{"internalType":"uint256","name":"uploadTime","type":"uint256"},{"internalType":"address","name":"uploader","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"string","name":"_filename","type":"string"},{"internalType":"string","name":"_filehash","type":"string"},{"internalType":"uint256","name":"_filesize","type":"uint256"},{"internalType":"string","name":"_filedescription","type":"string"}],"name":"addFiles","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"fileIndex","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"}]}'),v=new w.eth.Contract(b.Mt,"0x85Ee842b9Ddd9d9F5Bb39E984a2bF39f3a8cAd75"),g=t(85241),T=t(11163),_=(0,g.create)("https://ipfs.infura.io:5001/api/v0"),C=function(e){var n=e.allFiles,t=(0,T.useRouter)(),r=u.useState(null),m=(0,l.Z)(r,2),j=m[0],b=m[1],g=u.useState(""),C=(0,l.Z)(g,2),F=C[0],k=C[1],S=u.useState(""),E=(0,l.Z)(S,2),I=(E[0],E[1]),H=u.useState(null),A=(0,l.Z)(H,2),N=(A[0],A[1]),D=u.useState(""),M=(0,l.Z)(D,2),O=M[0],P=M[1],z=u.useState(""),R=(0,l.Z)(z,2),B=R[0],X=R[1],q=u.useState(!1),J=(0,l.Z)(q,2),U=J[0],G=J[1],K=u.useState(!1),L=(0,l.Z)(K,2),Q=L[0],V=L[1],W=function(){var e=(0,s.Z)(a().mark((function e(n){var i,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),G(!0),e.prev=2,e.next=5,_.add(j);case 5:return i=e.sent,r="https://ipfs.infura.io/ipfs/".concat(i.path),e.t0=v.methods.addFiles(F,r,B,O),e.next=10,w.eth.getAccounts();case 10:e.t1=e.sent[0],e.t2={from:e.t1},e.t0.send.call(e.t0,e.t2),G(!1),t.push("/"),e.next=21;break;case 17:e.prev=17,e.t3=e.catch(2),V(e.t3.message),G(!1);case 21:case"end":return e.stop()}}),e,null,[[2,17]])})));return function(n){return e.apply(this,arguments)}}();return(0,i.jsx)("div",{children:(0,i.jsxs)(c.Z,{children:[(0,i.jsxs)(p.Z,{style:{marginTop:"10px"},children:[(0,i.jsx)(p.Z.Item,{children:(0,i.jsx)("h1",{children:"D-File Share"})}),(0,i.jsx)(p.Z.Item,{children:(0,i.jsx)("p",{children:"A decentralized file share application"})})]}),(0,i.jsx)(d.Z,{fluid:!0,children:(0,i.jsx)(o.Z,{children:(0,i.jsxs)(f.Z,{onSubmit:W,error:Q,children:[(0,i.jsx)(f.Z.Input,{onChange:function(e){return P(e.target.value)},label:"Description",required:!0,placeholder:"Enter about the file"}),(0,i.jsx)(f.Z.Input,{onChange:function(e){e.preventDefault();var n=e.target.files[0];b(n);var t=new window.FileReader(n);t.readAsArrayBuffer(n),t.onloadend=function(){N(t.result),k(n.name),I(n.type),X(n.size)}},label:"File",type:"file",placeholder:""}),(0,i.jsx)(h.Z,{primary:!0,loading:U,children:"Submit"}),(0,i.jsxs)(x.Z,{error:!0,children:[(0,i.jsx)(x.Z.Header,{children:"Opps!!"}),(0,i.jsx)("p",{children:Q})]})]})})}),(0,i.jsxs)(y.Z,{celled:!0,children:[(0,i.jsx)(y.Z.Header,{children:(0,i.jsxs)(y.Z.Row,{children:[(0,i.jsx)(y.Z.HeaderCell,{children:"File name"}),(0,i.jsx)(y.Z.HeaderCell,{children:"File description"}),(0,i.jsx)(y.Z.HeaderCell,{children:"Uploader Address"}),(0,i.jsx)(y.Z.HeaderCell,{children:"File shareable link"})]})}),(0,i.jsx)(Z.Z,{children:n.map((function(e,n){return(0,i.jsxs)(y.Z.Row,{children:[(0,i.jsx)(y.Z.Cell,{children:e[1]}),(0,i.jsx)(y.Z.Cell,{children:e[4]}),(0,i.jsx)(y.Z.Cell,{children:e[6]}),(0,i.jsxs)(y.Z.Cell,{children:[(0,i.jsx)(h.Z,{positive:!0,onClick:function(){return navigator.clipboard.writeText("".concat(e[2]))},children:"Click here to copy link"}),(0,i.jsx)("br",{}),"  ",(0,i.jsx)("br",{}),(0,i.jsx)("a",{href:"".concat(e[2]),children:"Open File"}),"  "]})]},n)}))})]})]})})};C.getInitialProps=(0,s.Z)(a().mark((function e(){var n,t,i,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=[],e.next=3,v.methods.fileIndex().call();case 3:t=e.sent,i=t;case 5:if(!(i>0)){e.next=13;break}return e.next=8,v.methods.Files(i).call();case 8:r=e.sent,n.push(r);case 10:i--,e.next=5;break;case 13:return e.abrupt("return",{allFiles:n});case 14:case"end":return e.stop()}}),e)})));var F=C},78581:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return t(53176)}])},46601:function(){},89214:function(){},71922:function(){},2363:function(){},82195:function(){},27790:function(){},47005:function(){},26937:function(){},26784:function(){},88795:function(){},52361:function(){},94616:function(){}},function(e){e.O(0,[774,106,388,888,179],(function(){return n=78581,e(e.s=n);var n}));var n=e.O();_N_E=n}]);